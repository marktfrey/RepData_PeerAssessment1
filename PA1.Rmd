---
title: "Reproducible Research: Peer Assessment 1"
output:
  html_document:
    keep_md: true
---

Before beginning, we set the global options for the file.
```{r echo=TRUE}
library('knitr')
library('ggplot2')

opts_chunk$set(echo=TRUE, results="asis")
```




---

## Part I: Loading and preprocessing the data

Check for the `data` directory and create it if necessary.
```{r}
if (!file.exists("data")) {
  dir.create("data")
}
```
This directory is ignored by git, so that we don't commit both the zipped and unzipped data.


If the zipfile exists but hasn't been extracted, extract it.
```{r}
if (!file.exists("data/activity.csv")) {
  unzip("activity.zip", exdir="data", overwrite=FALSE)
}
```

Read in the data from the file.
```{r}
data <- read.csv("data/activity.csv")
```




---

## Part II: What is mean total number of steps taken per day?

> For this part of the assignment, you can ignore the missing values in the dataset.


### Make a histogram of the total number of steps taken each day

To prepare the histogram, we first need to aggregate the steps by date.

```{r}
daily_steps <- aggregate(steps ~ date, data = data, sum)
```

Note that aggregate throws out the days for which there is `NA` data - there are 61 unique days in the dataset, but only 53 of them have steps logged.

Then we can produce the histogram.  Setting the bin width to 500 gives a clearer picture of the distribution.

```{r steps_per_day_histogram}
ggplot(data = daily_steps, aes(daily_steps$steps)) +
      geom_histogram(binwidth = 500) +
      ggtitle('Days with Step Count') +
      xlab('Steps') +
      ylab('Days')
```


### Calculate and report the mean and median total number of steps taken per day

Using the aggreated data, we can calculate the mean (rounded to two decimal places)

```{r results='hide'}
steps_mean <- format(mean(daily_steps$steps), nsmall=2)
```

and the median

```{r results='hide'}
steps_median <- median(daily_steps$steps)
```

and report the figures.

The mean daily step count is __`r steps_mean`__ steps per day, and the median daily step count is __`r steps_median`__ steps per day.



---

## What is the average daily activity pattern?

### Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)

To produce the time series plot, we first need to aggregate the data by interval.

```{r}
interval_mean <- aggregate(steps ~ interval, data = data, mean)
```

Then plot it as a line

```{r interval_mean_line}
ggplot(data = interval_mean, aes(y = interval_mean$steps,
                                 x = interval_mean$interval)
       ) +
      geom_line() +
      ggtitle('Mean Daily Steps/Interval') +
      xlab('Interval') +
      ylab('Mean Steps')
```

### Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

We can identify the maximum interval and see that it matches with the observations from the graph

```{r, results = 'hide'}
max_interval <- interval_mean[interval_mean$steps == max(interval_mean$steps), ]
```

The maximum 5-minute interval is number __`r max_interval$interval`__, with an average step count of __`r max_interval$steps`__.



---

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
